<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>0xsalt GitHub Stars</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon points='50,5 63,35 97,40 72,62 78,95 50,80 22,95 28,62 3,40 37,35' fill='%23f0c14b'/></svg>">
  <style>
    /* ── Phase 1: Design Tokens ── */
    :root {
      /* Colors */
      --gold: #f0c14b;
      --gold-dim: #c9a227;
      --gold-bg: rgba(240, 193, 75, 0.08);
      --gold-glow: rgba(240, 193, 75, 0.25);
      --orange: #e8a317;
      --blue: #58a6ff;
      --blue-dim: #388bfd;
      --blue-glow: rgba(56, 139, 253, 0.15);
      --green: #3fb950;
      --green-bg: rgba(63, 185, 80, 0.1);
      --purple: #bc8cff;
      --bg-body: #0d1117;
      --bg-card: #161b22;
      --bg-card-hover: #1c2129;
      --bg-surface: #0d1117;
      --bg-input: #0d1117;
      --border: #30363d;
      --border-hover: #484f58;
      --border-focus: #58a6ff;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --red: #f85149;
      --red-bg: rgba(248, 81, 73, 0.1);
      --shimmer-base: #21262d;
      --shimmer-highlight: #30363d;

      /* Spacing scale */
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 12px;
      --space-lg: 16px;
      --space-xl: 24px;
      --space-2xl: 32px;
      --space-3xl: 48px;

      /* Typography scale */
      --text-xs: 0.7rem;
      --text-sm: 0.8rem;
      --text-base: 0.875rem;
      --text-md: 0.95rem;
      --text-lg: 1.05rem;
      --text-xl: 1.25rem;
      --text-2xl: 1.5rem;
      --text-3xl: 2rem;

      /* Elevation */
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);

      /* Transitions */
      --ease-out: cubic-bezier(0.22, 1, 0.36, 1);
      --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 400ms;

      /* Radius */
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --radius-pill: 999px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg-body);
      color: var(--text-primary);
      padding: clamp(1rem, 4vw, 2.5rem);
      min-height: 100vh;
      background-image:
        radial-gradient(ellipse 60% 40% at 50% 0%, rgba(56, 139, 253, 0.06) 0%, transparent 70%),
        radial-gradient(ellipse 50% 50% at 80% 100%, rgba(240, 193, 75, 0.04) 0%, transparent 60%);
    }

    /* ── Container ── */
    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    /* ── Header / Hero ── */
    header {
      text-align: center;
      margin-bottom: var(--space-xl);
      position: relative;
      overflow: hidden;
      padding: var(--space-2xl) var(--space-lg) var(--space-xl);
    }

    .hero-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      height: 300px;
      border-radius: 50%;
      background: radial-gradient(circle, var(--gold-glow) 0%, transparent 70%);
      pointer-events: none;
      opacity: 0;
      animation: glowFadeIn 1.5s ease-out 0.3s forwards;
    }

    .hero-label {
      font-size: var(--text-xs);
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: var(--space-md);
      opacity: 0;
      animation: fadeSlideIn 0.6s ease-out 0.1s forwards;
    }

    .hero-star-count {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.4em;
      margin-bottom: var(--space-sm);
      opacity: 0;
      animation: fadeSlideIn 0.6s ease-out 0.25s forwards;
    }

    .hero-star-icon {
      width: clamp(2rem, 6vw, 3rem);
      height: clamp(2rem, 6vw, 3rem);
      fill: var(--gold);
      filter: drop-shadow(0 0 8px var(--gold-glow));
      animation: starPulse 3s ease-in-out infinite;
    }

    .hero-number {
      font-size: clamp(3rem, 10vw, 5.5rem);
      font-weight: 800;
      letter-spacing: -0.03em;
      color: var(--gold);
      font-variant-numeric: tabular-nums;
      text-shadow: 0 0 40px var(--gold-glow);
    }

    .hero-descriptor {
      font-size: var(--text-base);
      color: var(--text-secondary);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      opacity: 0;
      animation: fadeSlideIn 0.6s ease-out 0.4s forwards;
    }

    .star-field {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .star-dot {
      position: absolute;
      width: 2px;
      height: 2px;
      border-radius: 50%;
      background: var(--gold);
      animation: twinkle var(--dur) ease-in-out var(--delay) infinite;
    }

    /* ── Phase 2: Summary Stats Bar ── */
    .stats-bar {
      display: flex;
      align-items: stretch;
      gap: 1px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      margin-bottom: var(--space-xl);
      overflow: hidden;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity var(--duration-slow) var(--ease-out),
                  transform var(--duration-slow) var(--ease-out);
    }

    .stats-bar.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .stat-item {
      flex: 1;
      background: var(--bg-card);
      padding: var(--space-md) var(--space-lg);
      text-align: center;
      min-width: 0;
    }

    .stat-number {
      font-size: var(--text-xl);
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      color: var(--text-primary);
      line-height: 1.2;
    }

    .stat-number.gold { color: var(--gold); }
    .stat-number.orange { color: var(--orange); }
    .stat-number.green { color: var(--green); }
    .stat-number.blue { color: var(--blue); }
    .stat-number.muted { color: var(--text-muted); }

    .stat-label {
      font-size: var(--text-xs);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* ── Phase 3: Search + Filter Toolbar ── */
    .toolbar {
      display: flex;
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
      flex-wrap: wrap;
      align-items: center;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity var(--duration-slow) var(--ease-out),
                  transform var(--duration-slow) var(--ease-out);
    }

    .toolbar.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .search-wrapper {
      flex: 1;
      min-width: 200px;
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: var(--space-md);
      top: 50%;
      transform: translateY(-50%);
      width: 15px;
      height: 15px;
      fill: var(--text-muted);
      pointer-events: none;
      transition: fill var(--duration-fast) ease;
    }

    .search-input {
      width: 100%;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-size: var(--text-base);
      padding: var(--space-sm) var(--space-lg) var(--space-sm) 36px;
      outline: none;
      transition: border-color var(--duration-fast) ease,
                  box-shadow var(--duration-fast) ease;
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .search-input:focus {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
    }

    .search-input:focus ~ .search-icon {
      fill: var(--blue);
    }

    .filter-select {
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-size: var(--text-sm);
      padding: var(--space-sm) var(--space-xl) var(--space-sm) var(--space-md);
      outline: none;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%238b949e' viewBox='0 0 16 16'%3E%3Cpath d='M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      transition: border-color var(--duration-fast) ease;
    }

    .filter-select:focus {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
    }

    .results-count {
      font-size: var(--text-sm);
      color: var(--text-muted);
      white-space: nowrap;
      font-variant-numeric: tabular-nums;
    }

    /* ── Phase 5: View Toggle ── */
    .view-toggle {
      display: flex;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      overflow: hidden;
      margin-left: auto;
    }

    .view-btn {
      background: var(--bg-card);
      border: none;
      color: var(--text-muted);
      padding: var(--space-sm) var(--space-md);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background var(--duration-fast) ease, color var(--duration-fast) ease;
    }

    .view-btn:not(:last-child) {
      border-right: 1px solid var(--border);
    }

    .view-btn.active {
      background: var(--blue-glow);
      color: var(--blue);
    }

    .view-btn:hover:not(.active) {
      background: var(--bg-card-hover);
      color: var(--text-secondary);
    }

    .view-btn svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    /* ── Repo List (Card View) ── */
    .repo-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    /* ── Repo Card ── */
    .repo-card {
      background: linear-gradient(135deg, var(--bg-card) 0%, #181d25 100%);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-lg) var(--space-xl);
      border-left: 3px solid transparent;
      transition: transform var(--duration-normal) var(--ease-out),
                  box-shadow var(--duration-normal) var(--ease-out),
                  border-color var(--duration-normal) var(--ease-out),
                  opacity var(--duration-normal) var(--ease-out);
      opacity: 0;
      transform: translateY(12px);
      position: relative;
      overflow: hidden;
    }

    .repo-card.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .repo-card:hover {
      transform: translateY(-2px) scale(1.005);
      box-shadow: var(--shadow-lg), 0 0 0 1px var(--blue-glow);
      border-color: var(--border-hover);
    }

    .repo-card.tier-gold {
      border-left-color: var(--gold);
    }
    .repo-card.tier-gold:hover {
      box-shadow: var(--shadow-lg), 0 0 12px var(--gold-glow);
    }

    .repo-card.tier-silver {
      border-left-color: var(--orange);
    }

    /* ── Star Bar ── */
    .star-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--gold) 0%, var(--orange) 100%);
      border-radius: 0 3px 0 0;
      width: 0;
      transition: width 0.8s var(--ease-out);
    }

    .repo-card.visible .star-bar {
      width: var(--star-pct);
      transition-delay: 0.3s;
    }

    /* ── Card Header ── */
    .repo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-xs);
      gap: var(--space-md);
    }

    .repo-name {
      color: var(--blue);
      text-decoration: none;
      font-weight: 600;
      font-size: var(--text-lg);
      position: relative;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .repo-name::after {
      content: "";
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 0;
      height: 1px;
      background: var(--blue);
      transition: width var(--duration-normal) ease;
    }

    .repo-name:hover::after {
      width: 100%;
    }

    /* ── Star Badge ── */
    .star-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.3em;
      background: var(--gold-bg);
      color: var(--gold);
      font-weight: 600;
      font-size: var(--text-sm);
      font-variant-numeric: tabular-nums;
      padding: 0.2em 0.6em;
      border-radius: var(--radius-pill);
      white-space: nowrap;
      flex-shrink: 0;
      position: relative;
    }

    .star-badge svg {
      width: 0.9em;
      height: 0.9em;
      fill: currentColor;
    }

    .star-badge.tier-gold {
      background: rgba(240, 193, 75, 0.15);
    }

    .star-badge.tier-silver {
      color: var(--orange);
      background: rgba(232, 163, 23, 0.1);
    }

    .star-badge.rank-1::after {
      content: "";
      position: absolute;
      top: -2px;
      right: -2px;
      width: 6px;
      height: 6px;
      background: var(--gold);
      border-radius: 50%;
      animation: sparkle 1.5s ease-in-out infinite;
    }

    /* ── Description ── */
    .repo-description {
      color: var(--text-secondary);
      font-size: var(--text-base);
      line-height: 1.5;
      margin-bottom: var(--space-xs);
    }

    /* ── Meta Row (Phase 4: Enhanced) ── */
    .repo-meta {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      font-size: var(--text-xs);
      color: var(--text-muted);
      margin-top: var(--space-sm);
      flex-wrap: wrap;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.3em;
    }

    .meta-item svg {
      width: 0.85em;
      height: 0.85em;
      fill: currentColor;
    }

    /* ── Language Badge (Phase 4) ── */
    .lang-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .lang-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* ── Activity Bar (Phase 4) ── */
    .activity-bar {
      width: 40px;
      height: 6px;
      background: var(--shimmer-base);
      border-radius: 3px;
      overflow: hidden;
      flex-shrink: 0;
    }

    .activity-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.6s var(--ease-out);
    }

    .activity-fill.hot { background: var(--green); }
    .activity-fill.warm { background: var(--gold); }
    .activity-fill.cool { background: var(--orange); }
    .activity-fill.cold { background: var(--text-muted); }

    /* ── Issue Badge (Phase 4) ── */
    .issue-badge {
      color: var(--green);
    }

    /* ── Phase 5: Table View ── */
    .repo-table {
      display: flex;
      flex-direction: column;
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
    }

    .table-header {
      display: grid;
      grid-template-columns: 1fr 80px 100px 2fr 90px;
      gap: var(--space-md);
      padding: var(--space-sm) var(--space-lg);
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
      font-size: var(--text-xs);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .table-row {
      display: grid;
      grid-template-columns: 1fr 80px 100px 2fr 90px;
      gap: var(--space-md);
      padding: var(--space-sm) var(--space-lg);
      border-bottom: 1px solid var(--border);
      align-items: center;
      font-size: var(--text-sm);
      transition: background var(--duration-fast) ease;
      opacity: 0;
      transform: translateY(4px);
    }

    .table-row.visible {
      opacity: 1;
      transform: translateY(0);
      transition: opacity var(--duration-normal) var(--ease-out),
                  transform var(--duration-normal) var(--ease-out),
                  background var(--duration-fast) ease;
    }

    .table-row:last-child {
      border-bottom: none;
    }

    .table-row:hover {
      background: var(--bg-card-hover);
    }

    .table-name {
      color: var(--blue);
      text-decoration: none;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .table-name:hover {
      text-decoration: underline;
    }

    .table-stars {
      color: var(--gold);
      font-weight: 600;
      font-variant-numeric: tabular-nums;
      display: flex;
      align-items: center;
      gap: 0.3em;
    }

    .table-stars svg {
      width: 0.85em;
      height: 0.85em;
      fill: currentColor;
    }

    .table-lang {
      display: flex;
      align-items: center;
      gap: 5px;
      color: var(--text-secondary);
    }

    .table-desc {
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .table-updated {
      color: var(--text-muted);
      font-size: var(--text-xs);
      white-space: nowrap;
    }

    /* ── Skeleton Loading ── */
    .skeleton-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .skeleton-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-lg) var(--space-xl);
      position: relative;
      overflow: hidden;
    }

    .skeleton-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--shimmer-highlight) 50%,
        transparent 100%
      );
      animation: shimmer 1.5s ease-in-out infinite;
    }

    .skeleton-line {
      background: var(--shimmer-base);
      border-radius: var(--radius-sm);
      height: 14px;
    }

    .skeleton-line.title { width: 40%; height: 16px; margin-bottom: 0.6rem; }
    .skeleton-line.desc { width: 75%; margin-bottom: 0.4rem; }
    .skeleton-line.meta { width: 25%; height: 10px; }

    .skeleton-badge {
      position: absolute;
      top: var(--space-lg);
      right: var(--space-xl);
      width: 50px;
      height: 22px;
      background: var(--shimmer-base);
      border-radius: var(--radius-pill);
    }

    /* ── Empty State ── */
    .empty-state {
      text-align: center;
      padding: var(--space-3xl) var(--space-lg);
      color: var(--text-muted);
    }

    .empty-state svg {
      width: 3rem;
      height: 3rem;
      fill: var(--text-muted);
      opacity: 0.4;
      margin-bottom: var(--space-lg);
    }

    /* ── No Results (filter) ── */
    .no-results {
      text-align: center;
      padding: var(--space-3xl) var(--space-lg);
      color: var(--text-muted);
      font-size: var(--text-base);
    }

    .no-results .hint {
      margin-top: var(--space-sm);
      font-size: var(--text-sm);
    }

    /* ── Error State ── */
    .error-box {
      text-align: center;
      padding: var(--space-xl);
      color: var(--red);
      background: var(--red-bg);
      border: 1px solid rgba(248, 81, 73, 0.25);
      border-radius: var(--radius-md);
      font-size: var(--text-md);
      line-height: 1.5;
    }

    /* ── Footer ── */
    footer {
      text-align: center;
      margin-top: var(--space-2xl);
      padding-top: var(--space-xl);
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: var(--text-xs);
    }

    /* ── Animations ── */
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes glowFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes starPulse {
      0%, 100% { filter: drop-shadow(0 0 8px var(--gold-glow)); }
      50% { filter: drop-shadow(0 0 16px var(--gold-glow)); }
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.15; }
      50% { opacity: 0.8; }
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0.3; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    /* ── Responsive ── */
    @media (max-width: 768px) {
      .star-field { display: none; }

      .stats-bar {
        flex-wrap: wrap;
      }

      .stat-item {
        flex: 1 1 calc(33.33% - 1px);
      }

      .table-header,
      .table-row {
        grid-template-columns: 1fr 70px 2fr;
      }

      .table-header > :nth-child(3),
      .table-header > :nth-child(5),
      .table-row > :nth-child(3),
      .table-row > :nth-child(5) {
        display: none;
      }
    }

    @media (max-width: 600px) {
      .repo-card { padding: var(--space-md) var(--space-lg); }
      .repo-name {
        white-space: normal;
        overflow: visible;
      }
      .repo-header {
        flex-wrap: wrap;
      }
      .toolbar {
        flex-direction: column;
      }
      .search-wrapper {
        width: 100%;
      }
      .view-toggle {
        margin-left: 0;
      }
      .stat-item {
        flex: 1 1 calc(50% - 1px);
      }
    }

    /* ── Reduced Motion ── */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-delay: 0ms !important;
        transition-duration: 0.01ms !important;
      }
      .repo-card, .table-row {
        opacity: 1;
        transform: none;
      }
      .repo-card .star-bar {
        transition: none;
      }
      .hero-label, .hero-star-count, .hero-descriptor, .hero-glow,
      .stats-bar, .toolbar {
        opacity: 1;
        transform: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="hero-glow"></div>
      <div class="star-field" id="star-field"></div>
      <div class="hero-label">0XSALT</div>
      <div class="hero-star-count">
        <svg class="hero-star-icon" viewBox="0 0 24 24"><polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/></svg>
        <span class="hero-number" id="hero-number">&mdash;</span>
      </div>
      <div class="hero-descriptor">GitHub Stars</div>
    </header>

    <!-- Phase 2: Summary Stats Bar -->
    <div class="stats-bar" id="stats-bar"></div>

    <!-- Phase 3: Search + Filters + Phase 5: View Toggle -->
    <div class="toolbar" id="toolbar" style="display: none;">
      <div class="search-wrapper">
        <input type="text" class="search-input" id="search-input" placeholder="Search repositories..." autocomplete="off">
        <svg class="search-icon" viewBox="0 0 16 16"><path d="M11.5 7a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-.82 4.74a6 6 0 111.06-1.06l3.04 3.04a.75.75 0 11-1.06 1.06l-3.04-3.04z"/></svg>
      </div>
      <select class="filter-select" id="filter-language">
        <option value="">All Languages</option>
      </select>
      <select class="filter-select" id="filter-tier">
        <option value="">All Tiers</option>
        <option value="gold">Gold</option>
        <option value="silver">Silver</option>
        <option value="other">Other</option>
      </select>
      <select class="filter-select" id="filter-activity">
        <option value="">All Activity</option>
        <option value="active">Active (&lt;30d)</option>
        <option value="moderate">Moderate (30-90d)</option>
        <option value="stale">Stale (&gt;90d)</option>
      </select>
      <span class="results-count" id="results-count"></span>
      <div class="view-toggle">
        <button class="view-btn active" id="btn-cards" title="Card view">
          <svg viewBox="0 0 16 16"><path d="M1 2.5A1.5 1.5 0 012.5 1h3A1.5 1.5 0 017 2.5v3A1.5 1.5 0 015.5 7h-3A1.5 1.5 0 011 5.5v-3zm8 0A1.5 1.5 0 0110.5 1h3A1.5 1.5 0 0115 2.5v3A1.5 1.5 0 0113.5 7h-3A1.5 1.5 0 019 5.5v-3zm-8 8A1.5 1.5 0 012.5 9h3A1.5 1.5 0 017 10.5v3A1.5 1.5 0 015.5 15h-3A1.5 1.5 0 011 13.5v-3zm8 0A1.5 1.5 0 0110.5 9h3a1.5 1.5 0 011.5 1.5v3a1.5 1.5 0 01-1.5 1.5h-3A1.5 1.5 0 019 13.5v-3z"/></svg>
        </button>
        <button class="view-btn" id="btn-table" title="Table view">
          <svg viewBox="0 0 16 16"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0114.25 16H1.75A1.75 1.75 0 010 14.25V1.75zM1.5 6.5v7.75c0 .138.112.25.25.25H5v-8H1.5zM5 5V1.5H1.75a.25.25 0 00-.25.25V5H5zm1.5 1.5v8h7.75a.25.25 0 00.25-.25V6.5H6.5zm8-1.5V1.75a.25.25 0 00-.25-.25H6.5V5h8z"/></svg>
        </button>
      </div>
    </div>

    <main id="content">
      <div class="skeleton-list">
        <div class="skeleton-card"><div class="skeleton-line title"></div><div class="skeleton-line desc"></div><div class="skeleton-line meta"></div><div class="skeleton-badge"></div></div>
        <div class="skeleton-card"><div class="skeleton-line title"></div><div class="skeleton-line desc"></div><div class="skeleton-line meta"></div><div class="skeleton-badge"></div></div>
        <div class="skeleton-card"><div class="skeleton-line title"></div><div class="skeleton-line desc"></div><div class="skeleton-line meta"></div><div class="skeleton-badge"></div></div>
        <div class="skeleton-card"><div class="skeleton-line title"></div><div class="skeleton-line desc"></div><div class="skeleton-line meta"></div><div class="skeleton-badge"></div></div>
        <div class="skeleton-card"><div class="skeleton-line title"></div><div class="skeleton-line desc"></div><div class="skeleton-line meta"></div><div class="skeleton-badge"></div></div>
      </div>
    </main>

    <footer>Repos sorted by stargazer count. Data from GitHub API.</footer>
  </div>

  <script>
    // ── Language Colors (GitHub) ──
    var LANG_COLORS = {
      JavaScript: "#f1e05a", TypeScript: "#3178c6", Python: "#3572A5",
      Go: "#00ADD8", Rust: "#dea584", Java: "#b07219", Ruby: "#701516",
      "C++": "#f34b7d", C: "#555555", "C#": "#178600", PHP: "#4F5D95",
      Swift: "#F05138", Kotlin: "#A97BFF", Shell: "#89e051", Lua: "#000080",
      HTML: "#e34c26", CSS: "#563d7c", Dart: "#00B4AB", Zig: "#ec915c",
      Vim: "#199f4b", "Vim Script": "#199f4b", Dockerfile: "#384d54",
      Makefile: "#427819", HCL: "#844FBA", Nix: "#7e7eff", Elixir: "#6e4a7e",
      Haskell: "#5e5086", Scala: "#c22d40", R: "#198CE7", Perl: "#0298c3",
      Jupyter: "#DA5B0B"
    };

    // ── SVGs ──
    var starSVG = '<svg viewBox="0 0 24 24"><polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/></svg>';
    var clockSVG = '<svg viewBox="0 0 16 16"><circle cx="8" cy="8" r="6.5" fill="none" stroke="currentColor" stroke-width="1.2"/><path d="M8 4.5V8l2.5 1.5" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>';
    var forkSVG = '<svg viewBox="0 0 16 16"><path d="M5 3.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm0 2.122a2.25 2.25 0 10-1.5 0v.878A2.25 2.25 0 005.75 8.5h1.5v2.128a2.251 2.251 0 101.5 0V8.5h1.5a2.25 2.25 0 002.25-2.25v-.878a2.25 2.25 0 10-1.5 0v.878a.75.75 0 01-.75.75h-4.5A.75.75 0 015 6.25v-.878zm3.75 7.378a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm3-8.75a.75.75 0 100-1.5.75.75 0 000 1.5z"/></svg>';
    var issueSVG = '<svg viewBox="0 0 16 16"><path d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/><path d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"/></svg>';

    // ── Module State ──
    var allRepos = [];
    var maxStars = 1;
    var urlParams = new URLSearchParams(window.location.search);
    var urlView = urlParams.get("view");
    var urlSearch = urlParams.get("q");
    var currentView = urlView || sessionStorage.getItem("hms-view") || "cards";

    // ── Star Field ──
    (function initStarField() {
      var field = document.getElementById("star-field");
      if (!field) return;
      for (var i = 0; i < 25; i++) {
        var dot = document.createElement("span");
        dot.className = "star-dot";
        dot.style.left = Math.random() * 100 + "%";
        dot.style.top = Math.random() * 100 + "%";
        dot.style.setProperty("--dur", (2 + Math.random() * 3).toFixed(1) + "s");
        dot.style.setProperty("--delay", (Math.random() * 4).toFixed(1) + "s");
        field.appendChild(dot);
      }
    })();

    // ── Animated Count-Up ──
    function animateCount(el, target, duration) {
      if (target === 0) { el.textContent = "0"; return; }
      var start = performance.now();
      function tick(now) {
        var t = Math.min((now - start) / duration, 1);
        var ease = 1 - Math.pow(1 - t, 3);
        el.textContent = Math.round(ease * target).toLocaleString();
        if (t < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    // ── Relative Time ──
    function relativeTime(dateStr) {
      var diff = Date.now() - new Date(dateStr).getTime();
      var mins = Math.floor(diff / 60000);
      if (mins < 1) return "just now";
      if (mins < 60) return mins + "m ago";
      var hrs = Math.floor(mins / 60);
      if (hrs < 24) return hrs + "h ago";
      var days = Math.floor(hrs / 24);
      if (days < 30) return days + "d ago";
      var months = Math.floor(days / 30);
      if (months < 12) return months + "mo ago";
      return Math.floor(months / 12) + "y ago";
    }

    // ── Days Since ──
    function daysSince(dateStr) {
      return Math.floor((Date.now() - new Date(dateStr).getTime()) / 86400000);
    }

    // ── Tier Classification ──
    function getTier(repo) {
      var pct = (repo.stargazers_count / maxStars) * 100;
      if (pct >= 50) return "gold";
      if (pct >= 20) return "silver";
      return "other";
    }

    // ── Activity Classification ──
    function getActivity(repo) {
      var d = daysSince(repo.pushed_at || repo.updated_at);
      if (d <= 30) return "active";
      if (d <= 90) return "moderate";
      return "stale";
    }

    // ── Activity Score (0-100) ──
    function activityScore(repo) {
      var d = daysSince(repo.pushed_at || repo.updated_at);
      if (d <= 7) return 100;
      if (d <= 30) return 80;
      if (d <= 90) return 50;
      if (d <= 180) return 25;
      return 10;
    }

    // ── Escape HTML ──
    function esc(str) {
      var el = document.createElement("span");
      el.textContent = str;
      return el.innerHTML;
    }

    // ── Fetch: try local API, fall back to GitHub API ──
    var GITHUB_USER = "0xsalt";

    async function fetchData() {
      try {
        var res = await fetch("/api/repos");
        if (res.ok) {
          var data = await res.json();
          if (!data.error) return data;
        }
      } catch (_) {}

      var repos = [];
      var page = 1;
      while (true) {
        var res = await fetch(
          "https://api.github.com/users/" + GITHUB_USER + "/repos?per_page=100&page=" + page + "&type=public",
          { headers: { Accept: "application/vnd.github.v3+json" } }
        );
        if (!res.ok) throw new Error("GitHub API: " + res.status);
        var batch = await res.json();
        if (batch.length === 0) break;
        for (var j = 0; j < batch.length; j++) {
          var r = batch[j];
          if (!r.fork) {
            repos.push({
              name: r.name,
              description: r.description,
              stargazers_count: r.stargazers_count,
              html_url: r.html_url,
              updated_at: r.updated_at,
              language: r.language,
              forks_count: r.forks_count || 0,
              open_issues_count: r.open_issues_count || 0,
              pushed_at: r.pushed_at || r.updated_at
            });
          }
        }
        if (batch.length < 100) break;
        page++;
      }
      repos.sort(function(a, b) { return b.stargazers_count - a.stargazers_count; });
      var totalStars = repos.reduce(function(s, r) { return s + r.stargazers_count; }, 0);
      return { repos: repos, totalStars: totalStars };
    }

    // ── Phase 2: Render Stats Bar ──
    function renderStatsBar(repos) {
      var bar = document.getElementById("stats-bar");
      var total = repos.length;
      var gold = 0, silver = 0, other = 0, active = 0, stale = 0;
      var langs = {};

      for (var i = 0; i < repos.length; i++) {
        var t = getTier(repos[i]);
        if (t === "gold") gold++;
        else if (t === "silver") silver++;
        else other++;

        var a = getActivity(repos[i]);
        if (a === "active") active++;
        else if (a === "stale") stale++;

        if (repos[i].language) langs[repos[i].language] = true;
      }

      var langCount = Object.keys(langs).length;

      bar.innerHTML =
        '<div class="stat-item"><div class="stat-number" id="stat-total">0</div><div class="stat-label">Total</div></div>' +
        '<div class="stat-item"><div class="stat-number gold" id="stat-gold">0</div><div class="stat-label">Gold</div></div>' +
        '<div class="stat-item"><div class="stat-number orange" id="stat-silver">0</div><div class="stat-label">Silver</div></div>' +
        '<div class="stat-item"><div class="stat-number green" id="stat-active">0</div><div class="stat-label">Active</div></div>' +
        '<div class="stat-item"><div class="stat-number muted" id="stat-stale">0</div><div class="stat-label">Stale</div></div>' +
        '<div class="stat-item"><div class="stat-number blue" id="stat-langs">0</div><div class="stat-label">Languages</div></div>';

      requestAnimationFrame(function() {
        bar.classList.add("visible");
        animateCount(document.getElementById("stat-total"), total, 800);
        animateCount(document.getElementById("stat-gold"), gold, 800);
        animateCount(document.getElementById("stat-silver"), silver, 800);
        animateCount(document.getElementById("stat-active"), active, 800);
        animateCount(document.getElementById("stat-stale"), stale, 800);
        animateCount(document.getElementById("stat-langs"), langCount, 800);
      });
    }

    // ── Phase 3: Populate Language Filter ──
    function populateLanguageFilter(repos) {
      var langs = {};
      for (var i = 0; i < repos.length; i++) {
        if (repos[i].language) {
          langs[repos[i].language] = (langs[repos[i].language] || 0) + 1;
        }
      }
      var sorted = Object.keys(langs).sort(function(a, b) { return langs[b] - langs[a]; });
      var sel = document.getElementById("filter-language");
      for (var j = 0; j < sorted.length; j++) {
        var opt = document.createElement("option");
        opt.value = sorted[j];
        opt.textContent = sorted[j] + " (" + langs[sorted[j]] + ")";
        sel.appendChild(opt);
      }
    }

    // ── Phase 3: Filter Logic ──
    function getFilteredRepos() {
      var query = document.getElementById("search-input").value.toLowerCase().trim();
      var lang = document.getElementById("filter-language").value;
      var tier = document.getElementById("filter-tier").value;
      var activity = document.getElementById("filter-activity").value;

      return allRepos.filter(function(repo) {
        if (query) {
          var searchable = (repo.name + " " + (repo.description || "") + " " + (repo.language || "")).toLowerCase();
          if (searchable.indexOf(query) === -1) return false;
        }
        if (lang && repo.language !== lang) return false;
        if (tier && getTier(repo) !== tier) return false;
        if (activity && getActivity(repo) !== activity) return false;
        return true;
      });
    }

    // ── Render Cards ──
    function renderCards(repos) {
      var container = document.getElementById("card-container");
      if (!container) {
        container = document.createElement("div");
        container.id = "card-container";
        container.className = "repo-list";
        document.getElementById("content").appendChild(container);
      }
      container.innerHTML = "";

      if (repos.length === 0) {
        container.innerHTML = '<div class="no-results">No repositories match your filters.<div class="hint">Try adjusting your search or filters.</div></div>';
        return;
      }

      for (var i = 0; i < repos.length; i++) {
        var repo = repos[i];
        var pct = Math.max((repo.stargazers_count / maxStars) * 100, 2);
        var tierClass = getTier(repo) === "gold" ? "tier-gold" : getTier(repo) === "silver" ? "tier-silver" : "";

        var card = document.createElement("div");
        card.className = "repo-card" + (tierClass ? " " + tierClass : "");
        card.style.setProperty("--star-pct", pct.toFixed(1) + "%");

        // Star bar
        var bar = document.createElement("div");
        bar.className = "star-bar";
        card.appendChild(bar);

        // Header row
        var hdr = document.createElement("div");
        hdr.className = "repo-header";

        var link = document.createElement("a");
        link.href = repo.html_url;
        link.target = "_blank";
        link.rel = "noopener";
        link.className = "repo-name";
        link.textContent = repo.name;

        var badge = document.createElement("span");
        var rank = allRepos.indexOf(repo);
        badge.className = "star-badge" + (tierClass ? " " + tierClass : "") + (rank === 0 ? " rank-1" : "");
        badge.innerHTML = starSVG + " " + repo.stargazers_count.toLocaleString();

        hdr.appendChild(link);
        hdr.appendChild(badge);
        card.appendChild(hdr);

        // Description
        if (repo.description) {
          var desc = document.createElement("p");
          desc.className = "repo-description";
          desc.textContent = repo.description;
          card.appendChild(desc);
        }

        // Meta row (Phase 4: enhanced)
        var meta = document.createElement("div");
        meta.className = "repo-meta";

        // Language badge
        if (repo.language) {
          var langEl = document.createElement("span");
          langEl.className = "meta-item lang-badge";
          var color = LANG_COLORS[repo.language] || "#8b949e";
          langEl.innerHTML = '<span class="lang-dot" style="background:' + color + '"></span>' + esc(repo.language);
          meta.appendChild(langEl);
        }

        // Forks
        if (repo.forks_count > 0) {
          var forkEl = document.createElement("span");
          forkEl.className = "meta-item";
          forkEl.innerHTML = forkSVG + " " + repo.forks_count.toLocaleString();
          meta.appendChild(forkEl);
        }

        // Issues
        if (repo.open_issues_count > 0) {
          var issueEl = document.createElement("span");
          issueEl.className = "meta-item issue-badge";
          issueEl.innerHTML = issueSVG + " " + repo.open_issues_count;
          meta.appendChild(issueEl);
        }

        // Updated
        var dateField = repo.pushed_at || repo.updated_at;
        if (dateField) {
          var updEl = document.createElement("span");
          updEl.className = "meta-item";
          updEl.innerHTML = clockSVG + " " + relativeTime(dateField);
          meta.appendChild(updEl);
        }

        // Activity bar
        var score = activityScore(repo);
        var actBar = document.createElement("span");
        actBar.className = "meta-item";
        var actClass = score >= 80 ? "hot" : score >= 50 ? "warm" : score >= 25 ? "cool" : "cold";
        actBar.innerHTML = '<span class="activity-bar"><span class="activity-fill ' + actClass + '" style="width:' + score + '%"></span></span>';
        meta.appendChild(actBar);

        card.appendChild(meta);
        container.appendChild(card);

        // Staggered entrance
        (function(c, idx) {
          setTimeout(function() { c.classList.add("visible"); }, 40 * idx);
        })(card, i);
      }
    }

    // ── Phase 5: Render Table ──
    function renderTable(repos) {
      var container = document.getElementById("table-container");
      if (!container) {
        container = document.createElement("div");
        container.id = "table-container";
        container.className = "repo-table";
        document.getElementById("content").appendChild(container);
      }
      container.innerHTML = "";

      if (repos.length === 0) {
        container.innerHTML = '<div class="no-results" style="padding:2rem">No repositories match your filters.</div>';
        return;
      }

      // Header
      var hdr = document.createElement("div");
      hdr.className = "table-header";
      hdr.innerHTML = "<span>Name</span><span>Stars</span><span>Language</span><span>Description</span><span>Updated</span>";
      container.appendChild(hdr);

      for (var i = 0; i < repos.length; i++) {
        var repo = repos[i];
        var row = document.createElement("div");
        row.className = "table-row";

        // Name
        var nameCell = document.createElement("a");
        nameCell.href = repo.html_url;
        nameCell.target = "_blank";
        nameCell.rel = "noopener";
        nameCell.className = "table-name";
        nameCell.textContent = repo.name;

        // Stars
        var starsCell = document.createElement("span");
        starsCell.className = "table-stars";
        starsCell.innerHTML = starSVG + " " + repo.stargazers_count.toLocaleString();

        // Language
        var langCell = document.createElement("span");
        langCell.className = "table-lang";
        if (repo.language) {
          var color = LANG_COLORS[repo.language] || "#8b949e";
          langCell.innerHTML = '<span class="lang-dot" style="background:' + color + '"></span>' + esc(repo.language);
        } else {
          langCell.textContent = "—";
        }

        // Description
        var descCell = document.createElement("span");
        descCell.className = "table-desc";
        descCell.textContent = repo.description || "—";

        // Updated
        var updCell = document.createElement("span");
        updCell.className = "table-updated";
        updCell.textContent = relativeTime(repo.pushed_at || repo.updated_at);

        row.appendChild(nameCell);
        row.appendChild(starsCell);
        row.appendChild(langCell);
        row.appendChild(descCell);
        row.appendChild(updCell);
        container.appendChild(row);

        // Staggered entrance
        (function(r, idx) {
          setTimeout(function() { r.classList.add("visible"); }, 25 * idx);
        })(row, i);
      }
    }

    // ── Update View ──
    function updateView() {
      var filtered = getFilteredRepos();

      // Update results count
      var countEl = document.getElementById("results-count");
      countEl.textContent = filtered.length + " of " + allRepos.length;

      // Clear content
      var content = document.getElementById("content");
      content.innerHTML = "";

      if (currentView === "cards") {
        renderCards(filtered);
      } else {
        renderTable(filtered);
      }
    }

    // ── Debounce ──
    function debounce(fn, delay) {
      var timer;
      return function() {
        clearTimeout(timer);
        timer = setTimeout(fn, delay);
      };
    }

    // ── Phase 5: View Toggle Setup ──
    function setupViewToggle() {
      var btnCards = document.getElementById("btn-cards");
      var btnTable = document.getElementById("btn-table");

      function setView(view) {
        currentView = view;
        sessionStorage.setItem("hms-view", view);
        btnCards.classList.toggle("active", view === "cards");
        btnTable.classList.toggle("active", view === "table");
        updateView();
      }

      btnCards.addEventListener("click", function() { setView("cards"); });
      btnTable.addEventListener("click", function() { setView("table"); });

      // Restore saved view
      btnCards.classList.toggle("active", currentView === "cards");
      btnTable.classList.toggle("active", currentView === "table");
    }

    // ── Phase 3: Wire Up Filters ──
    function setupFilters() {
      var searchInput = document.getElementById("search-input");
      var debouncedUpdate = debounce(updateView, 150);

      searchInput.addEventListener("input", debouncedUpdate);
      document.getElementById("filter-language").addEventListener("change", updateView);
      document.getElementById("filter-tier").addEventListener("change", updateView);
      document.getElementById("filter-activity").addEventListener("change", updateView);
    }

    // ── Main ──
    async function loadRepos() {
      var content = document.getElementById("content");
      var heroNumber = document.getElementById("hero-number");

      try {
        var data = await fetchData();

        // Hero count-up
        animateCount(heroNumber, data.totalStars, 1200);
        document.title = data.totalStars + " Stars \u2013 0xsalt";

        if (data.repos.length === 0) {
          content.innerHTML = "";
          var empty = document.createElement("div");
          empty.className = "empty-state";
          empty.innerHTML = starSVG.replace("<svg", '<svg width="48" height="48"') + "<p>No public repositories found</p>";
          content.appendChild(empty);
          return;
        }

        // Store globally
        allRepos = data.repos;
        maxStars = allRepos[0].stargazers_count || 1;

        // Phase 2: Stats bar
        renderStatsBar(allRepos);

        // Phase 3: Populate language filter + show toolbar
        populateLanguageFilter(allRepos);
        var toolbar = document.getElementById("toolbar");
        toolbar.style.display = "";
        requestAnimationFrame(function() { toolbar.classList.add("visible"); });

        // Phase 5: View toggle
        setupViewToggle();

        // Phase 3: Wire filters
        setupFilters();

        // Apply URL search param if present
        if (urlSearch) {
          document.getElementById("search-input").value = urlSearch;
        }

        // Initial render
        updateView();

      } catch (error) {
        content.innerHTML = "";
        heroNumber.textContent = "\u2014";
        var errorDiv = document.createElement("div");
        errorDiv.className = "error-box";
        errorDiv.textContent = "Error: " + error.message;
        content.appendChild(errorDiv);
      }
    }

    loadRepos();
  </script>
</body>
</html>
